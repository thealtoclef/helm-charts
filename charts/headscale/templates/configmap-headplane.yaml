{{- if .Values.headplane.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: headplane-config
  labels:
    {{- include "headscale.labels" . | nindent 4 }}
data:
  config.yaml: |
    server:
      host: "0.0.0.0"
      port: 3000
      cookie_secure: true
      cookie_secret: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa # placeholder only
    headscale:
      url: {{ .Values.url }}
      config_path: /etc/headscale/config.yaml
      config_strict: true
    integration:
      kubernetes:
        enabled: true
        validate_manifest: true
        pod_name: placeholder
    {{- toYaml .Values.headplane.config | nindent 4 }}
{{- end }}
